{include file='header'/}
<div id="performance-top">
<h5>编辑大礼包</h5>
</div>

<form action="{:url('/admin/Promotiongiftinfo/save/')}" method="post" class="definewidth">

 <div id="performance-top">
	 <h6>
		 基本信息
	 </h6>
	 <table  class="table table-bordered table-hover  m10 common_input common_select">
		<tr>
			<td width="10%" class="tableleft">礼包名称</td>
			<td class="tl" colspan="3"><input type="text" maxlength="20"  class="control-group controls"   placeholder="请输入礼包名称" value="{present name="data.name"}{$data.name}{/present}" name="name"/></td>
		</tr>
		<tr>
			<td class="tableleft">宣传图片</td>
			<td  class="tl" colspan="3">
			
			<div {notpresent name="data.pic"} style="display:none" {/notpresent} id="pic_img_div"><img id="pic_img" src="{present name="data.pic"}{$data.pic}{/present}" width="100px" height="100px"></div>
			<input type="button" id="pic" value="选择图片" />
		</tr>
		<tr>
			<td class="tableleft">礼包类型</td>
			<td  class="tl">
			<select name="type" id="type" onchange="changeLevelInputDiv()">
			{foreach name="listLevel" item="item"}
				<option  value="{$item.id}" {present name="data.type"} {if condition="$data.type eq $item.id"} selected="selected" {/if} {/present} >{$item.name}</option>
			{/foreach}
			</select>
			</td>
			<td class="tableleft">关联商品</td>
			<td  class="tl">
				<select name="product_id" id="product_id">
				{foreach name="productList" item="item"}
				<option value="{$item.id}" {if condition="$item.id eq $data.product_id"} selected="selected" {/if}>{$item.product_name}</option>
				{/foreach}
				</select>
			</td>
		</tr>
		<tr>
			<td class="tableleft">礼包价格</td>
			<td  class="tl"><input type="text" placeholder="请输入礼包价格" value="{present name="data.price"}{$data.price}{/present}" name="price"/></td>
			<td class="tableleft">礼包数量</td>
			<td  class="tl"><input type="text" placeholder="请输入礼包数量" value="{present name="data.number"}{$data.number}{/present}" name="number"/></td>
		
		</tr>
	 </table>
 </div>
 <div id="performance-top">
	<h6>
		礼包奖励 
	</h6>
	<h7>礼包奖励比例系数请设置在（1-100）之间</h7>
	<div id="gift_reward_setting_div">
		<table  class="table table-bordered table-hover common_input   m10">
		
			<tr>
				<td>角色</td>
			  {for start='0' end='$deep'}	
				<td>{$i+1}度奖励系数</td>
			   {/for}
			</tr>
			
			{foreach name="listLevel" item="item"}
			<tr>
				<td>{$item.name}</td>
				{for start="0" end="$deep"}
					{if condition="$item.id >= $data['type']"}
					<input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
					<td class="tl"><input  class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
					{else /}
						<!-- 铜牌 -->
						 {if condition="$item.id eq $minLevel && $i eq 0"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td colspan="6" class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 
						 <!-- 银牌-->
						 {if condition="$item.id eq $minLevel+1 && $i eq 0"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+1 && $i eq 1"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td colspan="5" class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 
						 <!-- 金牌-->
						 {if condition="$item.id eq $minLevel+2 && $i eq 0"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+2 && $i eq 1"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+2 && $i eq 2"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td colspan="4" class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 
						 <!-- 钻石-->
						 {if condition="$item.id eq $minLevel+3 && $i eq 0"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+3 && $i eq 1"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+3 && $i eq 2"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+3 && $i eq 3"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td colspan="3" class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 
						 <!-- 皇冠-->
						 {if condition="$item.id eq $minLevel+4 && $i eq 0"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+4 && $i eq 1"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+4 && $i eq 2"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+4 && $i eq 3"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td  class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 {if condition="$item.id eq $minLevel+4 && $i eq 4"}
							 <input  type="hidden" class="input-medium" name="id_{$item.id}_{$i}" value="{present name="item['roleRatioId'][$i+1]"}{$item['roleRatioId'][$i+1]}{/present}" >
							<td colspan="2" class="tl"><input class="input-small" type="text" name="value_{$item.id}_{$i}"  value="{present name="item['roleRatioValue'][$i+1]"}{$item['roleRatioValue'][$i+1]}{/present}"></td>
						 {/if}
						 
						 
					{/if}
				{/for}
			</tr>
			{/foreach}
			
		</table>
	</div>
 </div>
 <div id="performance-top">
	<h6>
			礼包描述 
	</h6>
	<textarea name="description" id="description" style="width:100%;height:300px;">{present name="data.description"}{$data.description}{/present}</textarea>
        
</div>
<div id="performance-top" class="button-center">
			<input type="hidden" name="pic_url" id="pic_url" value="{present name="data.pic"}{$data.pic}{/present}">
        	<input type="hidden" name="id" id="id" value="{present name="data.id"}{$data.id}{/present}">
            <button type="submit" class="btn btn-primary m10" type="button">保存</button>
             &nbsp;&nbsp;
             <button type="button" class="btn btn-success m10" name="backid" id="backid">返回列表</button>
</div>
</form>
</body>
</html>
<!--编辑器上传引入开始-->
<script src="/static/kindeditor/kindeditor-all.js " type="text/javascript"></script>
<script src="/static/kindeditor/lang/zh-CN.js " type="text/javascript"></script>
<!--编辑器上传引入结束-->
<script>
//编辑器
KindEditor.ready(function(K) {
    window.editor = K.create('#description');
    
	K('#pic').click(function() {
		editor.loadPlugin('image', function() {
			editor.plugin.imageDialog({
				showRemote : false,
				imageUrl : K('#pic_url').val(),
				clickFn : function(url, title, width, height, border, align) {
					K('#pic_url').val(url);
					$('#pic_img').attr('src',url);
					$('#pic_img_div').show();
					editor.hideDialog();
				}
			});
		});
	});
    
});

    $(function () {       
		$('#backid').click(function(){
				window.location.href="{:url('/admin/Promotiongiftinfo/index')}";
		 });

    });
    
    function changeLevelInputDiv()
    {
    	var type=$('#type').val();
    	if(type!='')
    	{
            $.ajax( {
                type : "post",
                url : '/admin/Promotiongiftinfo/levelRewardListDiv' ,
                dataType : 'json',
                data: {id:type},
                success : function(data) {
                	$('#gift_reward_setting_div').html(data);
                },
            });	
    	}
    }
</script>