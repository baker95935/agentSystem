<!DOCTYPE html>
<html>
<head>
    <title>代理商排行榜</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/static/Css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/static/Css/style.css" />
    <link rel="stylesheet" type="text/css" href='/static/Css/agentsystem-admin.css'/>
    <!--S-->
    <link rel="stylesheet" type="text/css" href="/static/Css/bootstrap-datepicker.min.css" />
    <!--E-->
    <link rel="stylesheet" type="text/css" href='/static/Js/layer-v3.1.1/theme/default/layer.css'/>
    <script type="text/javascript" src="/static/Js/jquery.js"></script>
    <script type="text/javascript" src="/static/Js/bootstrap.js"></script>
    <!--S-->
    <script type="text/javascript" src='/static/Js/bootstrap-datepicker.min.js'></script>
    <script type="text/javascript" src='/static/Js/bootstrap-datepicker.zh-CN.min.js'></script>
    <script type="text/javascript" src="/static/Js/layer-v3.1.1/layer.js"></script>
    <!--E-->
    <style type="text/css">
        body {
            padding-bottom: 40px;
        }
        .sidebar-nav {
            padding: 9px 0;
        }
        @media (max-width: 980px) {
            /* Enable use of floated navbar text */
            .navbar-text.pull-right {
                float: none;
                padding-left: 5px;
                padding-right: 5px;
            }
        }
    </style>
</head>
<body>
    <div id="performance-top">
        <h5>代理商排行榜</h5>
    </div>
<ul class="nav nav-tabs" style="margin-left:20px;">
    <li class="active">
        <a href="javascript:;">销量排名</a>
    </li>
    <li><a href="{:url('Agents/applyListAgentAudit')}">总奖励排名</a></li>
    <li><a href="{:url('Agents/applyListAgentAgree')}">绩效奖励排名</a></li>
    <li><a href="{:url('Agents/applyListAgentDisagree')}">代理团队排名</a></li>
    <li><a href="{:url('Agents/addAgent')}">推荐人数排名</a></li>
</ul>
<form class="form-inline definewidth m20" method="get">
    <table class="search_table" >
        <tr>
            <td class="td_r">代理商ID：</td>
            <td> <input type="text" name="a_id" value="{present name='search.a_id'}{$search.a_id}{/present}" class="abc input-default search_input" />
            </td>
            <td class="td_r td_pl">代理商姓名：</td>
            <td> <input type="text" name="name" value="{present name='search.name'}{$search.name}{/present}" class="abc input-default search_input" />
            </td>
            <td class="td_r td_pl"> 联系方式：</td>
            <td> <input type="text" name="name" value="{present name='search.name'}{$search.name}{/present}" class="abc input-default search_input" />
            <td class="td_r td_pl">角色：</td>
            <td><select name='role' class="search_input">
                    <option value='-1'{notpresent name='search.role'} selected{/notpresent}>全　部</option>
                    {foreach name="role_lang" item="role_lang_v" key="role_lang_k"}
                    <option value='{$role_lang_k}'{present name='search.role'}{if condition='$role_lang_k eq $search.role'} selected{/if}{/present}>{$role_lang_v}</option>
                    {/foreach}
                </select></td>
        </tr>

        <tr>
             <!-- 销量排名 & 总奖励排名 -->
            <td class="td_r"> 申请时间：</td>
            <td><input type="text" name="begin" value="{present name='search.begin'}{$search.begin}{/present}" class="search_input abc input-default datepicker" />
            </td>
            <td class="td_c">~</td>
            <td> <input type="text" name="end" value="{present name='search.end'}{$search.end}{/present}" class=" search_input abc input-default datepicker" />
            </td>
            <!-- 销量排名 & 总奖励排名 end-->
             <!-- 绩效奖励排名 -->
            <td class="td_r td_pl"> 月份：</td>
                <td> <input type="text" name="name" value="{present name='search.name'}{$search.name}{/present}" class="abc input-default search_input" />
            <!-- 绩效奖励排名 end-->
            <td colspan=6 class="td_l td_pl"><button type="button" class="btn btn-primary search">查询</button>&nbsp;&nbsp;<button type="button" class="btn btn-success export">导出</button></td>
        </tr>


    </table>
</form>
<table class="table table-bordered table-hover definewidth m10">
    <thead>
        <tr>
            <th class="tc">排名</th>
            <th class="tc">代理商ID</th>
            <th class="tc">姓名（昵称）</th>
            <th class="tc">联系方式</th>
            <th class="tc">身份</th>
            <!-- 销量排名 -->
            <th class="tc">总销售额</th>
            <!-- 销量排名 end-->

            <!-- 总奖励排名 -->
            <th class="tc">总奖励金额</th>
            <!-- 总奖励排名 end-->

            <!-- 绩效奖励排名 -->
            <th class="tc">月份</th>
            <th class="tc">绩效奖励金额</th>
             <!-- 绩效奖励排名 end-->

            <!-- 代理团队排名 -->
            <th class="tc">角色</th>
            <!-- 代理团队排名 end-->

            <!-- 推荐人数排名 -->
            <th class="tc">推荐人数</th>
            <!-- 推荐人数排名 end-->
        </tr>
    </thead>
    {empty name='list'}
    <tr>
        <td colspan='11'>暂时没有申请</td>
    </tr>
    {else/}
        {foreach name="list" item="item"}
    <tr>
        <td class="tc infourl"></td>
        <td></td>
        <td class="tl infourl"></td>
        <td class="infourl"></td>
        <td class="infourl">1代<br/>金牌身份</td>
        <td class="tc infourl"></td>
        <td class="tr infourl"></td>
        <td class="tr infourl"></td>
        <td class="tr infourl"></td>
        <td class="tc infourl"></td>
        <td class="tl">
            10
        </td>
    </tr>
        {/foreach}
    {/empty}
</table>
<div class="inline pull-right page">
{$list->render()}
</div>
<input type="hidden" id="agentId"/>
</body>
<script type="text/javascript">
    $('.datepicker').datepicker({
        autoclose: true,          //自动关闭
        calendarWeeks: false,     //是否显示今年是第几周
        clearBtn: true,           //显示清除按钮
        daysOfWeekDisabled: [],   //星期几不可选
        endDate: Infinity,        //日历结束日期
        forceParse: true,         //是否强制转换不符合格式的字符串
        format: 'yyyy-mm-dd',     //日期格式
        keyboardNavigation: true, //是否显示箭头导航
        language: 'zh-CN',        //语言
        minViewMode: 0,
        orientation: "auto",      //方向
        rtl: false,
        startDate: -Infinity,     //日历开始日期
        startView: 0,             //开始显示
        todayBtn: false,          //今天按钮
        todayHighlight: true,     //今天高亮
        weekStart: 0              //星期几是开始
    });
</script>
<script type="text/javascript">
    $(function () {

        // 重置密码
        $('.resetkey').click(function(){
            layer.confirm("确认重置密码?",{btn:['确定','取消']},function(){

                var _a_id = $(this).data('aid');
                $.post('{:url("/admin/Agents/resetAgentPassword")}',{a_id:_a_id},function(){ layer.alert('新密码为手机号后6位');  });
             },function(index){ layer.close(index); });
        });

        // 删除
        $('.del').click(function(){
            var _id = $(this).data('id');

            layer.confirm("确认删除该代理商？",{btn:['确定','取消']},function(){

                $.post('{:url("/admin/Agents/delAgent/")}',{id:_id},function(e){window.location.reload();},'json');
             },function(index){ layer.close(index); });
        });

        // 查询
        $('.search').click(function(){
            var _start = $('input[name=begin]').val();
            var _end  = $('input[name=end]').val();
            if(_start && _end){
                _start = new Date(_start.replace("-", "/").replace("-", "/"));
                _end = new Date(_end.replace("-", "/").replace("-", "/"));
                if(_start>_end){

                    layer.alert('结束时间必须晚于开始时间！');
                    return false;
                }
            }
            $('form').attr('action',"{:url('/admin/Agents/agentsList')}").submit();
        });

        // 导出
        $('.export').click(function(){
            var _start = $('input[name=begin]').val();
            var _end  = $('input[name=end]').val();
            if(_start && _end){
                _start = new Date(_start.replace("-", "/").replace("-", "/"));
                _end = new Date(_end.replace("-", "/").replace("-", "/"));
                if(_start>_end){

                    layer.alert('结束时间必须晚于开始时间！');
                    return false;
                }
            }
            $('form').attr('action',"{:url('/admin/Agents/exportAgent')}").submit();
        });

    });
    function poperLayer(stype,obj){
        $("#agentId").val(obj);
        var linkpage=null;
        var strTitle=null;
        var pWidth='600px';
        var pHeight='300px';
        switch(stype){
            case 1://变更上级代理
            var pHeight='250px';
            strTitle='<span style="font-size:16px;font-weight: bolder;">变更上级代理关系<span>'
            linkpage='agentsChangeRelationship.html';
            break;
            case 2://升级代理身份
            strTitle='<span style="font-size:16px;font-weight: bolder;">升级代理身份<span>'
            linkpage='agentsUpgradeIdentity.html';
            break;
        }
        layer.open({
                    type: 2,
                    area: [pWidth, pHeight],
                    fixed: false, //不固定
                    maxmin: true,
                    title:strTitle,
                    content: linkpage,
                    end: function () {
                        $("#orderId").val("");
                    }
            });
    }

</script>
</html>